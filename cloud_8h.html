<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Virgil IoT SDK: modules/cloud/include/virgil/iot/cloud/cloud.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Virgil IoT SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e05d7e2b1ecd646af5bb94391405f3b5.html">modules</a></li><li class="navelem"><a class="el" href="dir_c2bc7b333dae3dc596d772ea49fb7d6a.html">cloud</a></li><li class="navelem"><a class="el" href="dir_f089a379f055159b0874978b1aafff14.html">include</a></li><li class="navelem"><a class="el" href="dir_0f6795bedb98b86ef12968f2efa803b4.html">virgil</a></li><li class="navelem"><a class="el" href="dir_fda2655504b22c1723d40a6b36928f6b.html">iot</a></li><li class="navelem"><a class="el" href="dir_2c555b5e0d235730541c2386d39e017c.html">cloud</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cloud.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Cloud implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;<a class="el" href="firmware_8h_source.html">virgil/iot/firmware/firmware.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="global-hal_8h_source.html">global-hal.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="status__code_8h_source.html">virgil/iot/status_code/status_code.h</a>&gt;</code><br />
</div>
<p><a href="cloud_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvs__cloud__impl__t.html">vs_cloud_impl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cloud implementation.  <a href="structvs__cloud__impl__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvs__cloud__mb__topics__list__t.html">vs_cloud_mb_topics_list_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of available topics.  <a href="structvs__cloud__mb__topics__list__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvs__cloud__message__bin__impl__t.html">vs_cloud_message_bin_impl_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message Bin implementation.  <a href="structvs__cloud__message__bin__impl__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5955a2525637687b6ad8b0ae53d39424"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a5955a2525637687b6ad8b0ae53d39424">VS_UPD_URL_STR_SIZE</a>&#160;&#160;&#160;200</td></tr>
<tr class="separator:a5955a2525637687b6ad8b0ae53d39424"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abb5864f3b497bbf75bee2cdb1cf4c1cc"><td class="memItemLeft" align="right" valign="top">typedef size_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#abb5864f3b497bbf75bee2cdb1cf4c1cc">vs_fetch_handler_cb_t</a>) (char *contents, size_t chunksize, void *userdata)</td></tr>
<tr class="memdesc:abb5864f3b497bbf75bee2cdb1cf4c1cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for data header download.  <a href="cloud_8h.html#abb5864f3b497bbf75bee2cdb1cf4c1cc">More...</a><br /></td></tr>
<tr class="separator:abb5864f3b497bbf75bee2cdb1cf4c1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4efdbb6b4a4f8afba0be72699ec6eef"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#ad4efdbb6b4a4f8afba0be72699ec6eef">vs_cloud_http_get_func_t</a>) (const char *url, char *out_data, <a class="el" href="cloud_8h.html#abb5864f3b497bbf75bee2cdb1cf4c1cc">vs_fetch_handler_cb_t</a> fetch_handler, void *hander_data, size_t *in_out_size)</td></tr>
<tr class="memdesc:ad4efdbb6b4a4f8afba0be72699ec6eef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for GET request processing.  <a href="cloud_8h.html#ad4efdbb6b4a4f8afba0be72699ec6eef">More...</a><br /></td></tr>
<tr class="separator:ad4efdbb6b4a4f8afba0be72699ec6eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e3520259dbbe345eaf84b99e9118bbf"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">vs_cloud_mb_process_custom_topic_cb_t</a>) (const char *topic, uint16_t topic_sz, const uint8_t *p_data, uint16_t length)</td></tr>
<tr class="memdesc:a3e3520259dbbe345eaf84b99e9118bbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for custom topics processing.  <a href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">More...</a><br /></td></tr>
<tr class="separator:a3e3520259dbbe345eaf84b99e9118bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa160fc61749b986043c3560e0d3eb50"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">vs_cloud_mb_process_default_topic_cb_t</a>) (const uint8_t *url, uint16_t length)</td></tr>
<tr class="memdesc:afa160fc61749b986043c3560e0d3eb50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for default topics processing.  <a href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">More...</a><br /></td></tr>
<tr class="separator:afa160fc61749b986043c3560e0d3eb50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69cd8ba939247438c21b729ba3c2a79"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#ac69cd8ba939247438c21b729ba3c2a79">vs_cloud_mb_init_func_t</a>) (const char *host, uint16_t port, const char *device_cert, const char *priv_key, const char *ca_cert)</td></tr>
<tr class="memdesc:ac69cd8ba939247438c21b729ba3c2a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message bin initialization.  <a href="cloud_8h.html#ac69cd8ba939247438c21b729ba3c2a79">More...</a><br /></td></tr>
<tr class="separator:ac69cd8ba939247438c21b729ba3c2a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec5267e1321c587a1c13a100b0dbb5b"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#afec5267e1321c587a1c13a100b0dbb5b">vs_cloud_mb_connect_subscribe_func_t</a>) (const char *client_id, const char *login, const char *password, const <a class="el" href="structvs__cloud__mb__topics__list__t.html">vs_cloud_mb_topics_list_t</a> *topic_list, <a class="el" href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">vs_cloud_mb_process_custom_topic_cb_t</a> process_topic)</td></tr>
<tr class="memdesc:afec5267e1321c587a1c13a100b0dbb5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message bin connection and topic subscribing implementation.  <a href="cloud_8h.html#afec5267e1321c587a1c13a100b0dbb5b">More...</a><br /></td></tr>
<tr class="separator:afec5267e1321c587a1c13a100b0dbb5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573e80c76f32bd60c36419b1d4b0523e"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a573e80c76f32bd60c36419b1d4b0523e">vs_cloud_mb_process_func_t</a>) (void)</td></tr>
<tr class="memdesc:a573e80c76f32bd60c36419b1d4b0523e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message Bin processing.  <a href="cloud_8h.html#a573e80c76f32bd60c36419b1d4b0523e">More...</a><br /></td></tr>
<tr class="separator:a573e80c76f32bd60c36419b1d4b0523e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad81282ea3af168d76e7f844ac1499dc2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2">vs_cloud_mb_topic_id_t</a> { <a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2a8aea50be81cac6ffa115fc1dfd6b4cf8">VS_CLOUD_MB_TOPIC_TL</a>, 
<a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2aba7b2d46ae8bc66199ce3068ba680644">VS_CLOUD_MB_TOPIC_FW</a>
 }</td></tr>
<tr class="memdesc:ad81282ea3af168d76e7f844ac1499dc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default topics.  <a href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2">More...</a><br /></td></tr>
<tr class="separator:ad81282ea3af168d76e7f844ac1499dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72ba197114686b142aa6b2a3f794e766"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a72ba197114686b142aa6b2a3f794e766">vs_cloud_parse_firmware_manifest</a> (void *payload, size_t payload_len, char *fw_url)</td></tr>
<tr class="memdesc:a72ba197114686b142aa6b2a3f794e766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse Firmware manifest obtained by MQTT.  <a href="cloud_8h.html#a72ba197114686b142aa6b2a3f794e766">More...</a><br /></td></tr>
<tr class="separator:a72ba197114686b142aa6b2a3f794e766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd9c57a00cd813a869828443a6d3a1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a9bd9c57a00cd813a869828443a6d3a1f">vs_cloud_parse_tl_mainfest</a> (void *payload, size_t payload_len, char *tl_url)</td></tr>
<tr class="memdesc:a9bd9c57a00cd813a869828443a6d3a1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse Trust List manifest obtained by MQTT.  <a href="cloud_8h.html#a9bd9c57a00cd813a869828443a6d3a1f">More...</a><br /></td></tr>
<tr class="separator:a9bd9c57a00cd813a869828443a6d3a1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa24413b90ec1054933e4fe54e70d5c0f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#aa24413b90ec1054933e4fe54e70d5c0f">vs_cloud_fetch_and_store_fw_file</a> (const char *fw_file_url, <a class="el" href="structvs__firmware__header__t.html">vs_firmware_header_t</a> *fetched_header)</td></tr>
<tr class="memdesc:aa24413b90ec1054933e4fe54e70d5c0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch and store Firmware.  <a href="cloud_8h.html#aa24413b90ec1054933e4fe54e70d5c0f">More...</a><br /></td></tr>
<tr class="separator:aa24413b90ec1054933e4fe54e70d5c0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a941fa2e3396beab87f93319e6ae9728a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a941fa2e3396beab87f93319e6ae9728a">vs_cloud_fetch_and_store_tl</a> (const char *tl_file_url)</td></tr>
<tr class="memdesc:a941fa2e3396beab87f93319e6ae9728a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch and store Trust List.  <a href="cloud_8h.html#a941fa2e3396beab87f93319e6ae9728a">More...</a><br /></td></tr>
<tr class="separator:a941fa2e3396beab87f93319e6ae9728a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bb32cb7cabca47490643787c008907"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a41bb32cb7cabca47490643787c008907">vs_cloud_message_bin_register_default_handler</a> (<a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2">vs_cloud_mb_topic_id_t</a> topic_id, <a class="el" href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">vs_cloud_mb_process_default_topic_cb_t</a> handler)</td></tr>
<tr class="memdesc:a41bb32cb7cabca47490643787c008907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register default processing for topic.  <a href="cloud_8h.html#a41bb32cb7cabca47490643787c008907">More...</a><br /></td></tr>
<tr class="separator:a41bb32cb7cabca47490643787c008907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5987cdf399116a0b5066caae073b7f94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a5987cdf399116a0b5066caae073b7f94">vs_cloud_message_bin_register_custom_handler</a> (<a class="el" href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">vs_cloud_mb_process_custom_topic_cb_t</a> handler)</td></tr>
<tr class="memdesc:a5987cdf399116a0b5066caae073b7f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register custom handler callback.  <a href="cloud_8h.html#a5987cdf399116a0b5066caae073b7f94">More...</a><br /></td></tr>
<tr class="separator:a5987cdf399116a0b5066caae073b7f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ba9b4f68babdb392aa7374fc4ea88d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a86ba9b4f68babdb392aa7374fc4ea88d">vs_cloud_message_bin_process</a> (void)</td></tr>
<tr class="memdesc:a86ba9b4f68babdb392aa7374fc4ea88d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process message bin.  <a href="cloud_8h.html#a86ba9b4f68babdb392aa7374fc4ea88d">More...</a><br /></td></tr>
<tr class="separator:a86ba9b4f68babdb392aa7374fc4ea88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42139c757181d7784901b42510239bb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cloud_8h.html#a42139c757181d7784901b42510239bb3">vs_cloud_init</a> (const <a class="el" href="structvs__cloud__impl__t.html">vs_cloud_impl_t</a> *cloud_impl, const <a class="el" href="structvs__cloud__message__bin__impl__t.html">vs_cloud_message_bin_impl_t</a> *message_bin_impl, <a class="el" href="structvs__hsm__impl__t.html">vs_hsm_impl_t</a> *hsm)</td></tr>
<tr class="memdesc:a42139c757181d7784901b42510239bb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize message bin.  <a href="cloud_8h.html#a42139c757181d7784901b42510239bb3">More...</a><br /></td></tr>
<tr class="separator:a42139c757181d7784901b42510239bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Cloud implementation. </p>
<p>Cloud library is used for the goals listed below :</p><ul>
<li>obtaining credentials from thing service</li>
<li>connecting to message bin broker over MQTT and subscribing list of topics</li>
<li>processing received messages over message bin</li>
<li>downloading firmware images and trust list files from cloud storage</li>
</ul>
<p>Virgil IoT SDK provides MQTT implementation based on AWS IoT library</p>
<h1><a class="anchor" id="cloud_usage"></a>
Cloud Usage</h1>
<p>Function <a class="el" href="cloud_8h.html#a86ba9b4f68babdb392aa7374fc4ea88d" title="Process message bin.">vs_cloud_message_bin_process</a> tries to obtain credentials for connecting to message bin broker from thing service using <a class="el" href="cloud_8h.html#ad4efdbb6b4a4f8afba0be72699ec6eef" title="Callback for GET request processing.">vs_cloud_http_get_func_t</a> and connect to broker using <a class="el" href="cloud_8h.html#afec5267e1321c587a1c13a100b0dbb5b" title="Message bin connection and topic subscribing implementation.">vs_cloud_mb_connect_subscribe_func_t</a>. Then it waits for new messages periodically calling <a class="el" href="cloud_8h.html#a573e80c76f32bd60c36419b1d4b0523e" title="Message Bin processing.">vs_cloud_mb_process_func_t</a>. User can register own handlers for events about new firmware or trust list by calling <a class="el" href="cloud_8h.html#a41bb32cb7cabca47490643787c008907" title="Register default processing for topic.">vs_cloud_message_bin_register_default_handler</a> or custom handler for raw data processing from some topics by calling <a class="el" href="cloud_8h.html#a5987cdf399116a0b5066caae073b7f94" title="Register custom handler callback.">vs_cloud_message_bin_register_custom_handler</a> Cloud library uses provision and firmware modules, which must be initialized before.</p>
<p>Here you can see an example of Cloud library initialization :</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code" href="structvs__cloud__impl__t.html">vs_cloud_impl_t</a> *cloud_impl;                          <span class="comment">// Cloud implementation</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="structvs__cloud__message__bin__impl__t.html">vs_cloud_message_bin_impl_t</a> *message_bin_impl;        <span class="comment">// Message bin implementation</span></div>
<div class="line"><a class="code" href="structvs__hsm__impl__t.html">vs_hsm_impl_t</a> *hsm_impl;                                    <span class="comment">// Security module implementation</span></div>
<div class="line"><a class="code" href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">vs_cloud_mb_process_default_topic_cb_t</a> tl_topic_process;    <span class="comment">// Trust List topic processor</span></div>
<div class="line"><a class="code" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> tl_storage_impl;                        <span class="comment">// Trust List storage implementation</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Provision module</span></div>
<div class="line"><a class="code" href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a>(<a class="code" href="provision_8h.html#a76606a23984995c11450f4df9c2abfab">vs_provision_init</a>(&amp;tl_storage_impl, hsm_impl), <span class="stringliteral">&quot;Cannot initialize Provision module&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cloud module</span></div>
<div class="line"><a class="code" href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a>(<a class="code" href="cloud_8h.html#a42139c757181d7784901b42510239bb3">vs_cloud_init</a>(cloud_impl, message_bin_impl, hsm_impl), <span class="stringliteral">&quot;Unable to initialize Cloud module&quot;</span>);</div>
<div class="line"><a class="code" href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a>(<a class="code" href="cloud_8h.html#a41bb32cb7cabca47490643787c008907">vs_cloud_message_bin_register_default_handler</a>(<a class="code" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2a8aea50be81cac6ffa115fc1dfd6b4cf8">VS_CLOUD_MB_TOPIC_TL</a>, tl_topic_process), <span class="stringliteral">&quot;Error register handler for Trust List topic&quot;</span>);</div>
</div><!-- fragment --><p>You can use <a class="el" href="curl-http_8h.html#af1efbd7c6d3daf07c6b91238cf78bc73">vs_curl_http_impl()</a> for <em>cloud_impl</em>, <a class="el" href="aws-message-bin_8h.html#a687a5d46d202651ebc807a6515a24fe1">vs_aws_message_bin_impl()</a> for <em>message_bin_impl</em>, <a class="el" href="vs-softhsm_8h.html#a69e91d29efbec80562216d03aba4e60d" title="Initialize software crypto implementation.">vs_softhsm_impl()</a> for <em>hsm_impl</em>. <em>tl_topic_process</em> is Trust List topic downloader.</p>
<p>Here you can see an example of Cloud library usage: </p><div class="fragment"><div class="line"> <span class="comment">//handlers for default topics example</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">firmware_topic_process(<span class="keyword">const</span> uint8_t *url, uint16_t length) {</div>
<div class="line">     <a class="code" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> res;</div>
<div class="line">     <a class="code" href="structvs__firmware__header__t.html">vs_firmware_header_t</a> header;</div>
<div class="line">     res = <a class="code" href="cloud_8h.html#aa24413b90ec1054933e4fe54e70d5c0f">vs_cloud_fetch_and_store_fw_file</a>(url, &amp;header);</div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6">VS_CODE_OK</a> == res) {</div>
<div class="line">         res = <a class="code" href="firmware_8h.html#ab39bcd474177b330b11426f080212fab">vs_firmware_verify_firmware</a>(&amp;header.<a class="code" href="structvs__firmware__header__t.html#a20bab7eda57f53e331d3fd41debc6516">descriptor</a>);</div>
<div class="line">         <span class="keywordflow">if</span> (<a class="code" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6">VS_CODE_OK</a> == res) {</div>
<div class="line">            <span class="comment">//Fetched firmware is correct. Do someting</span></div>
<div class="line">         } <span class="keywordflow">else</span> {</div>
<div class="line">             <span class="comment">// Incorrect firmware image. We can delete it.</span></div>
<div class="line">             <a class="code" href="firmware_8h.html#abd837887bf4afc3afbd8b7ea635fe967">vs_firmware_delete_firmware</a>(&amp;header.<a class="code" href="structvs__firmware__header__t.html#a20bab7eda57f53e331d3fd41debc6516">descriptor</a>);</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">tl_topic_process(<span class="keyword">const</span> uint8_t *url, uint16_t length) {</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6">VS_CODE_OK</a> == <a class="code" href="cloud_8h.html#a941fa2e3396beab87f93319e6ae9728a">vs_cloud_fetch_and_store_tl</a>(url)) {</div>
<div class="line">         <span class="comment">// Trust list is correct. Do something</span></div>
<div class="line">     }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Processing of cloud library functionality example</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">message_bin_mqtt_task(<span class="keywordtype">void</span> *params) {</div>
<div class="line">   <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6">VS_CODE_OK</a> == <a class="code" href="cloud_8h.html#a86ba9b4f68babdb392aa7374fc4ea88d">vs_cloud_message_bin_process</a>()) {</div>
<div class="line">           sleep(500);</div>
<div class="line">       } <span class="keywordflow">else</span> {</div>
<div class="line">           sleep(5000);</div>
<div class="line">       }</div>
<div class="line">    }</div>
<div class="line"> }</div>
</div><!-- fragment --> </div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a5955a2525637687b6ad8b0ae53d39424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5955a2525637687b6ad8b0ae53d39424">&#9670;&nbsp;</a></span>VS_UPD_URL_STR_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VS_UPD_URL_STR_SIZE&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ad4efdbb6b4a4f8afba0be72699ec6eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4efdbb6b4a4f8afba0be72699ec6eef">&#9670;&nbsp;</a></span>vs_cloud_http_get_func_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(* vs_cloud_http_get_func_t) (const char *url, char *out_data, <a class="el" href="cloud_8h.html#abb5864f3b497bbf75bee2cdb1cf4c1cc">vs_fetch_handler_cb_t</a> fetch_handler, void *hander_data, size_t *in_out_size)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for GET request processing. </p>
<p>This function callback has to load requested data and to store it in <em>out_data</em> output buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">url</td><td>URL for data download. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out_data</td><td>Output buffer to store processed data if fetch_handler has not been specified. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fetch_handler</td><td>Callback to process information that has been downloaded. If NULL, default processing will be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hander_data</td><td>Context from <em>fetch_handler</em> <em>userdata</em> parameter. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">in_out_size</td><td>Data size storage. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="afec5267e1321c587a1c13a100b0dbb5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afec5267e1321c587a1c13a100b0dbb5b">&#9670;&nbsp;</a></span>vs_cloud_mb_connect_subscribe_func_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(* vs_cloud_mb_connect_subscribe_func_t) (const char *client_id, const char *login, const char *password, const <a class="el" href="structvs__cloud__mb__topics__list__t.html">vs_cloud_mb_topics_list_t</a> *topic_list, <a class="el" href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">vs_cloud_mb_process_custom_topic_cb_t</a> process_topic)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Message bin connection and topic subscribing implementation. </p>
<p>This callback must connect to the message bin broker and subscribe topics. <a class="el" href="aws-message-bin_8h.html#a687a5d46d202651ebc807a6515a24fe1">vs_aws_message_bin_impl()</a> returns <a class="el" href="structvs__cloud__message__bin__impl__t.html" title="Message Bin implementation.">vs_cloud_message_bin_impl_t</a> structure with default implementation provided by Virgil IoT SDK library. You can analyze function pointed by <em>connect_subscribe</em> member for an example.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">client_id</td><td>Client identifier. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">login</td><td>Login. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>Password. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic_list</td><td>Pointer to the list of topics. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">process_topic</td><td>Callback for topics processing. Cannot be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="ac69cd8ba939247438c21b729ba3c2a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69cd8ba939247438c21b729ba3c2a79">&#9670;&nbsp;</a></span>vs_cloud_mb_init_func_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(* vs_cloud_mb_init_func_t) (const char *host, uint16_t port, const char *device_cert, const char *priv_key, const char *ca_cert)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Message bin initialization. </p>
<p>This callback must initialize MQTT with specified URL and certificates. <a class="el" href="aws-message-bin_8h.html#a687a5d46d202651ebc807a6515a24fe1">vs_aws_message_bin_impl()</a> returns <a class="el" href="structvs__cloud__message__bin__impl__t.html" title="Message Bin implementation.">vs_cloud_message_bin_impl_t</a> structure with default implementation provided by Virgil IoT SDK library. You can analyze function pointed by <em>init</em> member for an example.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">host</td><td>Host URL. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">port</td><td>Port for host access. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">device_cert</td><td>Device certificate to be send to the broker. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">priv_key</td><td>Device private key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_cert</td><td>Broker's certificate. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a3e3520259dbbe345eaf84b99e9118bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e3520259dbbe345eaf84b99e9118bbf">&#9670;&nbsp;</a></span>vs_cloud_mb_process_custom_topic_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* vs_cloud_mb_process_custom_topic_cb_t) (const char *topic, uint16_t topic_sz, const uint8_t *p_data, uint16_t length)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for custom topics processing. </p>
<p>This callback has to process topics as raw data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Topic name. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic_sz</td><td>Topic name size. Cannot be zero. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_data</td><td>Topic data. Cannot be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length</td><td>Topic data size. Cannot be zero. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afa160fc61749b986043c3560e0d3eb50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa160fc61749b986043c3560e0d3eb50">&#9670;&nbsp;</a></span>vs_cloud_mb_process_default_topic_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* vs_cloud_mb_process_default_topic_cb_t) (const uint8_t *url, uint16_t length)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for default topics processing. </p>
<p>Virgil IoT SDK preprocesses topics from <a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2" title="Default topics.">vs_cloud_mb_topic_id_t</a> enumeration. It calls this callback if it is necessary to load data for this topic.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">url</td><td>Topic URL. Cannot be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length</td><td>Topic URL size. Cannot be zero. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a573e80c76f32bd60c36419b1d4b0523e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a573e80c76f32bd60c36419b1d4b0523e">&#9670;&nbsp;</a></span>vs_cloud_mb_process_func_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(* vs_cloud_mb_process_func_t) (void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Message Bin processing. </p>
<p>Callback for message bin processing. <a class="el" href="aws-message-bin_8h.html#a687a5d46d202651ebc807a6515a24fe1">vs_aws_message_bin_impl()</a> returns <a class="el" href="structvs__cloud__message__bin__impl__t.html" title="Message Bin implementation.">vs_cloud_message_bin_impl_t</a> structure with default implementation provided by Virgil IoT SDK library. You can analyze function pointed by <em>process</em> member for an example.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="abb5864f3b497bbf75bee2cdb1cf4c1cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5864f3b497bbf75bee2cdb1cf4c1cc">&#9670;&nbsp;</a></span>vs_fetch_handler_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef size_t(* vs_fetch_handler_cb_t) (char *contents, size_t chunksize, void *userdata)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for data header download. </p>
<p>This function callback stores loaded handler in internal buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">contents</td><td>Input data. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chunksize</td><td>Input data size. Must not be zero. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">userdata</td><td>Data specific context. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Loaded data size of <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432" title="Status code Status code to be returned from function.">vs_status_e</a> error code </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ad81282ea3af168d76e7f844ac1499dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad81282ea3af168d76e7f844ac1499dc2">&#9670;&nbsp;</a></span>vs_cloud_mb_topic_id_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2">vs_cloud_mb_topic_id_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default topics. </p>
<p>This is the list of default topics processed by <a class="el" href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50" title="Callback for default topics processing.">vs_cloud_mb_process_default_topic_cb_t()</a> callback. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad81282ea3af168d76e7f844ac1499dc2a8aea50be81cac6ffa115fc1dfd6b4cf8"></a>VS_CLOUD_MB_TOPIC_TL&#160;</td><td class="fielddoc"><p>Trust List. </p>
</td></tr>
<tr><td class="fieldname"><a id="ad81282ea3af168d76e7f844ac1499dc2aba7b2d46ae8bc66199ce3068ba680644"></a>VS_CLOUD_MB_TOPIC_FW&#160;</td><td class="fielddoc"><p>Firmware. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa24413b90ec1054933e4fe54e70d5c0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa24413b90ec1054933e4fe54e70d5c0f">&#9670;&nbsp;</a></span>vs_cloud_fetch_and_store_fw_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_fetch_and_store_fw_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fw_file_url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvs__firmware__header__t.html">vs_firmware_header_t</a> *&#160;</td>
          <td class="paramname"><em>fetched_header</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetch and store Firmware. </p>
<p>Fetches Firmware and stores it in internal storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fw_file_url</td><td>Firmware URL to fetch. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fetched_header</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a941fa2e3396beab87f93319e6ae9728a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a941fa2e3396beab87f93319e6ae9728a">&#9670;&nbsp;</a></span>vs_cloud_fetch_and_store_tl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_fetch_and_store_tl </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tl_file_url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetch and store Trust List. </p>
<p>Fetches Trust List and stores it in internal storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tl_file_url</td><td>Trust List URL to fetch. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a42139c757181d7784901b42510239bb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42139c757181d7784901b42510239bb3">&#9670;&nbsp;</a></span>vs_cloud_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvs__cloud__impl__t.html">vs_cloud_impl_t</a> *&#160;</td>
          <td class="paramname"><em>cloud_impl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structvs__cloud__message__bin__impl__t.html">vs_cloud_message_bin_impl_t</a> *&#160;</td>
          <td class="paramname"><em>message_bin_impl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvs__hsm__impl__t.html">vs_hsm_impl_t</a> *&#160;</td>
          <td class="paramname"><em>hsm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize message bin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cloud_impl</td><td>Cloud implementation. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_bin_impl</td><td>Message bin implementation. You can use default implementation returned by <a class="el" href="aws-message-bin_8h.html#a687a5d46d202651ebc807a6515a24fe1">vs_aws_message_bin_impl()</a>. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsm</td><td>Security module implementation. You can use default implementation returned by <a class="el" href="vs-softhsm_8h.html#a69e91d29efbec80562216d03aba4e60d" title="Initialize software crypto implementation.">vs_softhsm_impl()</a>. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a86ba9b4f68babdb392aa7374fc4ea88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ba9b4f68babdb392aa7374fc4ea88d">&#9670;&nbsp;</a></span>vs_cloud_message_bin_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_message_bin_process </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process message bin. </p>
<p>Initializes message bin if needed and processes protocol. Normally this function is called in the MQTT processing infinite loop.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a5987cdf399116a0b5066caae073b7f94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5987cdf399116a0b5066caae073b7f94">&#9670;&nbsp;</a></span>vs_cloud_message_bin_register_custom_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_message_bin_register_custom_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cloud_8h.html#a3e3520259dbbe345eaf84b99e9118bbf">vs_cloud_mb_process_custom_topic_cb_t</a>&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register custom handler callback. </p>
<p>Registers custom topics processing. You can use <a class="el" href="cloud_8h.html#a41bb32cb7cabca47490643787c008907" title="Register default processing for topic.">vs_cloud_message_bin_register_default_handler()</a> if it is enough default topics processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>Custom topics processing handler. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a41bb32cb7cabca47490643787c008907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41bb32cb7cabca47490643787c008907">&#9670;&nbsp;</a></span>vs_cloud_message_bin_register_default_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_message_bin_register_default_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2">vs_cloud_mb_topic_id_t</a>&#160;</td>
          <td class="paramname"><em>topic_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">vs_cloud_mb_process_default_topic_cb_t</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register default processing for topic. </p>
<p>Registers topic processing handlers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic_id</td><td>Topic identifier. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">handler</td><td>Topic processing callback. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a72ba197114686b142aa6b2a3f794e766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72ba197114686b142aa6b2a3f794e766">&#9670;&nbsp;</a></span>vs_cloud_parse_firmware_manifest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_parse_firmware_manifest </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fw_url</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse Firmware manifest obtained by MQTT. </p>
<p>Parse Firmware manifest obtained by MQTT and return URL for Firmware download.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">payload</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">payload_len</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fw_url</td><td>Buffer for Firmware download URL. Must be enough to store <a class="el" href="cloud_8h.html#a5955a2525637687b6ad8b0ae53d39424">VS_UPD_URL_STR_SIZE</a> bytes. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<a id="a9bd9c57a00cd813a869828443a6d3a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bd9c57a00cd813a869828443a6d3a1f">&#9670;&nbsp;</a></span>vs_cloud_parse_tl_mainfest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_cloud_parse_tl_mainfest </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>tl_url</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse Trust List manifest obtained by MQTT. </p>
<p>Parse Trust List manifest obtained by MQTT and return URL for Firmware download.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">payload</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">payload_len</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tl_url</td><td>Buffer for Trust List download URL. Must be enough to store <a class="el" href="cloud_8h.html#a5955a2525637687b6ad8b0ae53d39424">VS_UPD_URL_STR_SIZE</a> bytes. Must not be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="astructvs__firmware__header__t_html"><div class="ttname"><a href="structvs__firmware__header__t.html">vs_firmware_header_t</a></div><div class="ttdoc">Firmware header.</div><div class="ttdef"><b>Definition:</b> firmware.h:68</div></div>
<div class="ttc" id="afirmware_8h_html_ab39bcd474177b330b11426f080212fab"><div class="ttname"><a href="firmware_8h.html#ab39bcd474177b330b11426f080212fab">vs_firmware_verify_firmware</a></div><div class="ttdeci">vs_status_e vs_firmware_verify_firmware(const vs_firmware_descriptor_t *descriptor)</div><div class="ttdoc">Verify firmware.</div></div>
<div class="ttc" id="astructvs__cloud__impl__t_html"><div class="ttname"><a href="structvs__cloud__impl__t.html">vs_cloud_impl_t</a></div><div class="ttdoc">Cloud implementation.</div><div class="ttdef"><b>Definition:</b> cloud.h:167</div></div>
<div class="ttc" id="astructvs__hsm__impl__t_html"><div class="ttname"><a href="structvs__hsm__impl__t.html">vs_hsm_impl_t</a></div><div class="ttdoc">HSM implementation.</div><div class="ttdef"><b>Definition:</b> hsm.h:473</div></div>
<div class="ttc" id="astructvs__firmware__header__t_html_a20bab7eda57f53e331d3fd41debc6516"><div class="ttname"><a href="structvs__firmware__header__t.html#a20bab7eda57f53e331d3fd41debc6516">vs_firmware_header_t::descriptor</a></div><div class="ttdeci">vs_firmware_descriptor_t descriptor</div><div class="ttdoc">Firnware descriptor.</div><div class="ttdef"><b>Definition:</b> firmware.h:74</div></div>
<div class="ttc" id="astatus__code_8h_html_af385b5c6ab5f3183ce75d4d1e676e432"><div class="ttname"><a href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a></div><div class="ttdeci">vs_status_e</div><div class="ttdoc">Status code Status code to be returned from function.</div><div class="ttdef"><b>Definition:</b> status_code.h:49</div></div>
<div class="ttc" id="astatus__code_8h_html_aa0d986d170e834631b902001dae653a2"><div class="ttname"><a href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a></div><div class="ttdeci">#define STATUS_CHECK(OPERATION, MESSAGE,...)</div><div class="ttdoc">Status code check and goto if non-successful.</div><div class="ttdef"><b>Definition:</b> status_code.h:109</div></div>
<div class="ttc" id="acloud_8h_html_ad81282ea3af168d76e7f844ac1499dc2a8aea50be81cac6ffa115fc1dfd6b4cf8"><div class="ttname"><a href="cloud_8h.html#ad81282ea3af168d76e7f844ac1499dc2a8aea50be81cac6ffa115fc1dfd6b4cf8">VS_CLOUD_MB_TOPIC_TL</a></div><div class="ttdoc">Trust List.</div><div class="ttdef"><b>Definition:</b> cloud.h:237</div></div>
<div class="ttc" id="acloud_8h_html_a41bb32cb7cabca47490643787c008907"><div class="ttname"><a href="cloud_8h.html#a41bb32cb7cabca47490643787c008907">vs_cloud_message_bin_register_default_handler</a></div><div class="ttdeci">vs_status_e vs_cloud_message_bin_register_default_handler(vs_cloud_mb_topic_id_t topic_id, vs_cloud_mb_process_default_topic_cb_t handler)</div><div class="ttdoc">Register default processing for topic.</div></div>
<div class="ttc" id="astatus__code_8h_html_af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6"><div class="ttname"><a href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6">VS_CODE_OK</a></div><div class="ttdoc">Successful operation.</div><div class="ttdef"><b>Definition:</b> status_code.h:52</div></div>
<div class="ttc" id="astructvs__cloud__message__bin__impl__t_html"><div class="ttname"><a href="structvs__cloud__message__bin__impl__t.html">vs_cloud_message_bin_impl_t</a></div><div class="ttdoc">Message Bin implementation.</div><div class="ttdef"><b>Definition:</b> cloud.h:342</div></div>
<div class="ttc" id="afirmware_8h_html_abd837887bf4afc3afbd8b7ea635fe967"><div class="ttname"><a href="firmware_8h.html#abd837887bf4afc3afbd8b7ea635fe967">vs_firmware_delete_firmware</a></div><div class="ttdeci">vs_status_e vs_firmware_delete_firmware(const vs_firmware_descriptor_t *descriptor)</div><div class="ttdoc">Delete firmware.</div></div>
<div class="ttc" id="acloud_8h_html_aa24413b90ec1054933e4fe54e70d5c0f"><div class="ttname"><a href="cloud_8h.html#aa24413b90ec1054933e4fe54e70d5c0f">vs_cloud_fetch_and_store_fw_file</a></div><div class="ttdeci">vs_status_e vs_cloud_fetch_and_store_fw_file(const char *fw_file_url, vs_firmware_header_t *fetched_header)</div><div class="ttdoc">Fetch and store Firmware.</div></div>
<div class="ttc" id="acloud_8h_html_a941fa2e3396beab87f93319e6ae9728a"><div class="ttname"><a href="cloud_8h.html#a941fa2e3396beab87f93319e6ae9728a">vs_cloud_fetch_and_store_tl</a></div><div class="ttdeci">vs_status_e vs_cloud_fetch_and_store_tl(const char *tl_file_url)</div><div class="ttdoc">Fetch and store Trust List.</div></div>
<div class="ttc" id="astructvs__storage__op__ctx__t_html"><div class="ttname"><a href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a></div><div class="ttdoc">Storage element context.</div><div class="ttdef"><b>Definition:</b> storage_hal.h:196</div></div>
<div class="ttc" id="aprovision_8h_html_a76606a23984995c11450f4df9c2abfab"><div class="ttname"><a href="provision_8h.html#a76606a23984995c11450f4df9c2abfab">vs_provision_init</a></div><div class="ttdeci">vs_status_e vs_provision_init(vs_storage_op_ctx_t *tl_storage_ctx, vs_hsm_impl_t *hsm)</div><div class="ttdoc">Provision initialization.</div></div>
<div class="ttc" id="acloud_8h_html_a42139c757181d7784901b42510239bb3"><div class="ttname"><a href="cloud_8h.html#a42139c757181d7784901b42510239bb3">vs_cloud_init</a></div><div class="ttdeci">vs_status_e vs_cloud_init(const vs_cloud_impl_t *cloud_impl, const vs_cloud_message_bin_impl_t *message_bin_impl, vs_hsm_impl_t *hsm)</div><div class="ttdoc">Initialize message bin.</div></div>
<div class="ttc" id="acloud_8h_html_a86ba9b4f68babdb392aa7374fc4ea88d"><div class="ttname"><a href="cloud_8h.html#a86ba9b4f68babdb392aa7374fc4ea88d">vs_cloud_message_bin_process</a></div><div class="ttdeci">vs_status_e vs_cloud_message_bin_process(void)</div><div class="ttdoc">Process message bin.</div></div>
<div class="ttc" id="acloud_8h_html_afa160fc61749b986043c3560e0d3eb50"><div class="ttname"><a href="cloud_8h.html#afa160fc61749b986043c3560e0d3eb50">vs_cloud_mb_process_default_topic_cb_t</a></div><div class="ttdeci">void(* vs_cloud_mb_process_default_topic_cb_t)(const uint8_t *url, uint16_t length)</div><div class="ttdoc">Callback for default topics processing.</div><div class="ttdef"><b>Definition:</b> cloud.h:264</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
