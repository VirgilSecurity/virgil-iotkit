<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Virgil IoT SDK: modules/protocols/snap/include/virgil/iot/protocols/snap/info/info-server.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Virgil IoT SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e05d7e2b1ecd646af5bb94391405f3b5.html">modules</a></li><li class="navelem"><a class="el" href="dir_2bd68166f0904077a554350189b98b53.html">protocols</a></li><li class="navelem"><a class="el" href="dir_adff384897c6499a4d18fea487943bf4.html">snap</a></li><li class="navelem"><a class="el" href="dir_fd0060761861f6d4b51729d7e8573b72.html">include</a></li><li class="navelem"><a class="el" href="dir_e3479dea0afb63e4a471c1a04c32f8b3.html">virgil</a></li><li class="navelem"><a class="el" href="dir_76c6552cc82eda007a698da937581b9e.html">iot</a></li><li class="navelem"><a class="el" href="dir_a545be9a4669b66880684555ddb858f1.html">protocols</a></li><li class="navelem"><a class="el" href="dir_30ba789c892c59a3b74ccd5ba53c5eb8.html">snap</a></li><li class="navelem"><a class="el" href="dir_89212aabb7c86c78a92fc93442eaf186.html">info</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">info-server.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>INFO for server.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="snap-structs_8h_source.html">virgil/iot/protocols/snap/snap-structs.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="firmware_8h_source.html">virgil/iot/firmware/firmware.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="info-structs_8h_source.html">info-structs.h</a>&quot;</code><br />
</div>
<p><a href="info-server_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3dedc2fc7975813dd65b82addd5c4671"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="info-server_8h.html#a3dedc2fc7975813dd65b82addd5c4671">vs_snap_info_start_notif_srv_cb_t</a>) (<a class="el" href="structvs__snap__info__device__t.html">vs_snap_info_device_t</a> *device)</td></tr>
<tr class="memdesc:a3dedc2fc7975813dd65b82addd5c4671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Startup notification.  <a href="info-server_8h.html#a3dedc2fc7975813dd65b82addd5c4671">More...</a><br /></td></tr>
<tr class="separator:a3dedc2fc7975813dd65b82addd5c4671"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a462ed38c75ba3c3ebf7eac326d6679da"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structvs__snap__service__t.html">vs_snap_service_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="info-server_8h.html#a462ed38c75ba3c3ebf7eac326d6679da">vs_snap_info_server</a> (<a class="el" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> *tl_ctx, <a class="el" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> *fw_ctx, <a class="el" href="info-server_8h.html#a3dedc2fc7975813dd65b82addd5c4671">vs_snap_info_start_notif_srv_cb_t</a> startup_cb)</td></tr>
<tr class="memdesc:a462ed38c75ba3c3ebf7eac326d6679da"><td class="mdescLeft">&#160;</td><td class="mdescRight">INFO Server SNAP Service implementation.  <a href="info-server_8h.html#a462ed38c75ba3c3ebf7eac326d6679da">More...</a><br /></td></tr>
<tr class="separator:a462ed38c75ba3c3ebf7eac326d6679da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87a8dd88c9e944fa2bfd4fcb3423875b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="info-server_8h.html#a87a8dd88c9e944fa2bfd4fcb3423875b">vs_snap_info_start_notification</a> (const <a class="el" href="structvs__netif__t.html">vs_netif_t</a> *netif)</td></tr>
<tr class="memdesc:a87a8dd88c9e944fa2bfd4fcb3423875b"><td class="mdescLeft">&#160;</td><td class="mdescRight">INFO Server startup notification.  <a href="info-server_8h.html#a87a8dd88c9e944fa2bfd4fcb3423875b">More...</a><br /></td></tr>
<tr class="separator:a87a8dd88c9e944fa2bfd4fcb3423875b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>INFO for server. </p>
<p>INFO service is used to provide information about current device state in the local network. Network in this case is limited by SNAP transport protocol.</p>
<p>In INFO meaning "Server" is any functional device. "Client" is the special device for statistic collection only. It can be any server PC or MCU device. Servers send their statistic information by startup. Also client can request periodical state sending by polling request.</p>
<h1><a class="anchor" id="info_server_usage"></a>
INFO Server usage</h1>
<p>Before first INFO calls usage it is necessary to register INFO Server service :</p>
<div class="fragment"><div class="line"><a class="code" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> tl_storage_impl;        <span class="comment">// Trust List storage implementation</span></div>
<div class="line"><a class="code" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> fw_storage_impl;        <span class="comment">// Firmware storage implementation</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="structvs__snap__service__t.html">vs_snap_service_t</a> *snap_info_server;  <span class="comment">// INFO Server SNAP service</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Initialize tl_storage_impl, fw_storage_impl</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Register INFO Server service</span></div>
<div class="line">snap_info_server = <a class="code" href="info-server_8h.html#a462ed38c75ba3c3ebf7eac326d6679da">vs_snap_info_server</a>(&amp;tl_storage_impl, &amp;fw_storage_impl, NULL);</div>
<div class="line"><a class="code" href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a>(<a class="code" href="snap_8h.html#a692661c304f19a0cd382d3948e3fa862">vs_snap_register_service</a>(snap_info_server), <span class="stringliteral">&quot;Cannot register INFO Server client service&quot;</span>);</div>
</div><!-- fragment --><p><em>tl_storage_impl</em> and <em>fw_storage_impl</em> are storage implementations. See <a class="el" href="storage__hal_8h.html#storage_hal">Storage HAL Usage</a> for details. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a3dedc2fc7975813dd65b82addd5c4671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dedc2fc7975813dd65b82addd5c4671">&#9670;&nbsp;</a></span>vs_snap_info_start_notif_srv_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a>(* vs_snap_info_start_notif_srv_cb_t) (<a class="el" href="structvs__snap__info__device__t.html">vs_snap_info_device_t</a> *device)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Startup notification. </p>
<p>Sends startup notification with device information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">device</td><td><a class="el" href="structvs__snap__info__device__t.html" title="Device information.">vs_snap_info_device_t</a> device information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432a81a1881ebbfde7ce78658862b9ec60b6" title="Successful operation.">VS_CODE_OK</a> in case of success or error code. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a462ed38c75ba3c3ebf7eac326d6679da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a462ed38c75ba3c3ebf7eac326d6679da">&#9670;&nbsp;</a></span>vs_snap_info_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structvs__snap__service__t.html">vs_snap_service_t</a>* vs_snap_info_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>tl_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>fw_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="info-server_8h.html#a3dedc2fc7975813dd65b82addd5c4671">vs_snap_info_start_notif_srv_cb_t</a>&#160;</td>
          <td class="paramname"><em>startup_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>INFO Server SNAP Service implementation. </p>
<p>This call returns INFO server implementation. It must be called before any INFO call.</p>
<dl class="section note"><dt>Note</dt><dd><em>startup_cb</em> can be NULL. In this case standard notifications will be done.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tl_ctx</td><td>Trust List storage context. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fw_ctx</td><td>Firmware storage context. Must not be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startup_cb</td><td>Startup notification server callback. If NULL, it won't be used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structvs__snap__service__t.html" title="SNAP service descriptor.">vs_snap_service_t</a> SNAP service description. Use this pointer to call <a class="el" href="snap_8h.html#a692661c304f19a0cd382d3948e3fa862" title="Register SNAP service.">vs_snap_register_service</a>. </dd></dl>

</div>
</div>
<a id="a87a8dd88c9e944fa2bfd4fcb3423875b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87a8dd88c9e944fa2bfd4fcb3423875b">&#9670;&nbsp;</a></span>vs_snap_info_start_notification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status__code_8h.html#af385b5c6ab5f3183ce75d4d1e676e432">vs_status_e</a> vs_snap_info_start_notification </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvs__netif__t.html">vs_netif_t</a> *&#160;</td>
          <td class="paramname"><em>netif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>INFO Server startup notification. </p>
<p>Sends startup notification.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">netif</td><td>SNAP service descriptor. If NULL, default one will be used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structvs__snap__service__t.html" title="SNAP service descriptor.">vs_snap_service_t</a> SNAP service description. Use this pointer to call <a class="el" href="snap_8h.html#a692661c304f19a0cd382d3948e3fa862" title="Register SNAP service.">vs_snap_register_service</a>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="astatus__code_8h_html_aa0d986d170e834631b902001dae653a2"><div class="ttname"><a href="status__code_8h.html#aa0d986d170e834631b902001dae653a2">STATUS_CHECK</a></div><div class="ttdeci">#define STATUS_CHECK(OPERATION, MESSAGE,...)</div><div class="ttdoc">Status code check and goto if non-successful.</div><div class="ttdef"><b>Definition:</b> status_code.h:109</div></div>
<div class="ttc" id="astructvs__snap__service__t_html"><div class="ttname"><a href="structvs__snap__service__t.html">vs_snap_service_t</a></div><div class="ttdoc">SNAP service descriptor.</div><div class="ttdef"><b>Definition:</b> snap-structs.h:307</div></div>
<div class="ttc" id="ainfo-server_8h_html_a462ed38c75ba3c3ebf7eac326d6679da"><div class="ttname"><a href="info-server_8h.html#a462ed38c75ba3c3ebf7eac326d6679da">vs_snap_info_server</a></div><div class="ttdeci">const vs_snap_service_t * vs_snap_info_server(vs_storage_op_ctx_t *tl_ctx, vs_storage_op_ctx_t *fw_ctx, vs_snap_info_start_notif_srv_cb_t startup_cb)</div><div class="ttdoc">INFO Server SNAP Service implementation.</div></div>
<div class="ttc" id="astructvs__storage__op__ctx__t_html"><div class="ttname"><a href="structvs__storage__op__ctx__t.html">vs_storage_op_ctx_t</a></div><div class="ttdoc">Storage element context.</div><div class="ttdef"><b>Definition:</b> storage_hal.h:200</div></div>
<div class="ttc" id="asnap_8h_html_a692661c304f19a0cd382d3948e3fa862"><div class="ttname"><a href="snap_8h.html#a692661c304f19a0cd382d3948e3fa862">vs_snap_register_service</a></div><div class="ttdeci">vs_status_e vs_snap_register_service(const vs_snap_service_t *service)</div><div class="ttdoc">Register SNAP service.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
